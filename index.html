<!DOCTYPE html>

<html>
	<head>
		<title>Connect Link</title>
<!-- script -->
<script type="text/javascript" src="http://platform.linkedin.com/in.js">
  api_key: 1m4xzx01cl9p
  onLoad: onLinkedInLoad
  authorize: true
  scope: r_basicprofile r_emailaddress r_network
</script>
<script type="text/javascript">
	// 2. Runs when the JavaScript framework is loaded
	function onLinkedInLoad() {
	     IN.Event.on(IN, "auth", onLinkedInAuth);
	}
	// 2. Runs when the viewer has authenticated
	function onLinkedInAuth() {
	//	alert("hi");
		IN.API.Profile("me").result(displayProfiles);
	}
	// 2. Runs when the Profile() API call returns successfully
	function displayProfiles(profiles) {
	     member = profiles.values[0];
	     document.getElementById("profiles").innerHTML = 
	          "<p id=\"" + member.id + "\">Hello " +  member.firstName + " " + member.lastName + "</p>";
	     IN.API.NetworkUpdates()
     		.params({"type": "SHAR", "count": 5}) // get the five most-recent Shares
     		.result(displayNetworkUpdates)
     		.error(displayNetworkUpdatesError);
	}
	function displayNetworkUpdates(updates) {
		console.debug(network);
		var profileDiv = document.getElementById("networkupdates");
     
		for (var i in updates.values) {
			var key = updates.values[i].updateKey; // each update has a unique key
			var share = updates.values[i].updateContent.person; // the person sharing content
			profileDiv.innerHTML += "<p id='" + key + "'>" + share.firstName + " " + share.lastName 
			 + " shared " + share.currentShare.comment + ".</p>";
		}     
	}
	function displayNetworkUpdatesError(error) {
		console.debug(error);
		alert("error occurred");
	}
</script>
<!-- /script -->
		
	</head>
	<body>
		<div id="wrapper">
			<!-- 3. Displays a button to let the viewer authenticate -->
			<script type="IN/Login">
				Hello, <?js= firstName ?> <?js= lastName ?>.
			</script>
			<!-- 4. Placeholder for the greeting -->
			<div id="profiles">
				
			</div>
			<div id="networkupdates">
				
			</div>
		</div>
	</body>
</html>